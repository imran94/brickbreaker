<!DOCTYPE html>
<html>
	<head>
		<title>Balls</title>
	</head>
	
	<body>
		<canvas id = "gameCanvas" width = "800" height ="600"></canvas>

		<script type="text/javascript">
			var ballX = 75;
			var ballY = 75;
			var ballSpeedX = 5;
			var ballSpeedY = 10;

			const BRICK_WIDTH = 100;
			const BRICK_HEIGHT = 50;
			const BRICK_GAP = 2;
			const BRICK_COUNT = 4;
			var brickGrid = new Array(BRICK_COUNT);

			const PADDLE_WIDTH = 100;
			const PADDLE_THICKNESS = 10;
			const PADDLE_DIST_FROM_EDGE = 60;
			var paddleX = 400;

			var mouseX = 0;
			var mouseY = 0;

			var canvas, canvasContext;

			function updateMousePos(evt) {
				var rect = canvas.getBoundingClientRect();
				var root = document.documentElement;

				mouseX = evt.clientX - rect.left - root.scrollLeft;
				mouseY = evt.clientY - rect.top - root.scrollTop;

				paddleX = mouseX - (PADDLE_WIDTH / 2);
			}

			function brickReset() {
				for (var i = 0; i < brickGrid.length; i++) {
					brickGrid[i] = true;
				}
			}

			window.onload = function() {
				canvas = document.getElementById('gameCanvas');
				canvasContext = canvas.getContext('2d');

				var framesPerSecond = 30;
				setInterval(updateAll, 1000/framesPerSecond);

				canvas.addEventListener('mousemove', updateMousePos);

				brickReset();
			}

			function drawRect(topLeftX, topLeftY, width, height, colour) {
				canvasContext.fillStyle = colour;
				canvasContext.fillRect(topLeftX,topLeftY, width,height);
			}

			function drawCircle(ballX, ballY, radius, colour) {
				canvasContext.fillStyle = colour;
				canvasContext.beginPath();
				canvasContext.arc(ballX, ballY, radius, 0, Math.PI * 2, true);
				canvasContext.fill();				
			}

			function drawText(text, textX,textY, color) {
				canvasContext.fillStyle = color;
				canvasContext.fillText(text, textX,textY);
			}

			function drawBricks() {
				for (var i = 0; i < brickGrid.length; i++) {
					if (brickGrid[i]) {
						colorRect(BRICK_WIDTH * i,0, BRICK_WIDTH - BRICK_GAP,BRICK_HEIGHT, 'blue');
					}
				}
			}

			function drawAll() {
				drawRect(0,0, canvas.width,canvas.height, 'black');
				drawCircle(ballX,ballY, 10, 'red');
				drawRect(paddleX, canvas.height-PADDLE_DIST_FROM_EDGE, PADDLE_WIDTH, PADDLE_THICKNESS, 'white');

				drawBricks();

				drawText(mouseX+", "+mouseY, mouseX, mouseY, 'yellow');
			}

			function moveAll() {
				var paddleTopEdgeY = canvas.height - PADDLE_DIST_FROM_EDGE;
				var paddleBottomEdgeY = paddleTopEdgeY + PADDLE_THICKNESS;
				var paddleLeftEdgeX = paddleX;
				var paddleRightEdgeX = paddleX + PADDLE_WIDTH;

				ballX += ballSpeedX;
				ballY += ballSpeedY;

				if (ballX > canvas.width || ballX <= 0) {
					ballSpeedX *= -1;
				}
				if (ballY < 0) {
					ballSpeedY *= -1;
				}
				if (ballY > canvas.height) {
					ballReset();
				}
				if (ballY >= paddleTopEdgeY && 
					ballY <= paddleBottomEdgeY &&
					ballX >= paddleLeftEdgeX &&
					ballX <= paddleRightEdgeX) {

					ballSpeedY *= -1

					var centerOfPaddleX = paddleX + PADDLE_WIDTH / 2;
					var ballDistFromPaddleCenter = ballX - centerOfPaddleX;

					ballSpeedX = ballDistFromPaddleCenter * 0.35;
				}
			}

			function updateAll() {
				moveAll();
				drawAll();
			}

			function ballReset() {
				ballX = canvas.width/2;
				ballY = canvas.height/2;
			}

		</script>

	</body>
</html>